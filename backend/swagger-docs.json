{"openapi":"3.0.0","info":{"title":"MedStaff API","version":"1.0.0","description":"API completa para o sistema MedStaff - Gestão de profissionais de saúde","contact":{"name":"Equipe MedStaff","email":"suporte@medstaff.com","url":"https://medstaff.com"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"}},"servers":[{"url":"http://localhost:3001","description":"Servidor de Desenvolvimento"},{"url":"https://api.medstaff.com","description":"Servidor de Produção"}],"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"Token JWT obtido através do endpoint de login"}},"schemas":{"User":{"type":"object","required":["email","password"],"properties":{"id":{"type":"string","format":"uuid","description":"ID único do usuário"},"email":{"type":"string","format":"email","description":"Email do usuário"},"password":{"type":"string","minLength":8,"description":"Senha do usuário (mínimo 8 caracteres)"},"name":{"type":"string","description":"Nome completo do usuário"},"role":{"type":"string","enum":["user","admin","superadmin"],"description":"Papel do usuário no sistema"},"isAdmin":{"type":"boolean","description":"Indica se o usuário é administrador"},"twoFactorEnabled":{"type":"boolean","description":"Indica se o 2FA está habilitado"},"createdAt":{"type":"string","format":"date-time","description":"Data de criação do usuário"},"updatedAt":{"type":"string","format":"date-time","description":"Data da última atualização"}}},"LoginRequest":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","example":"usuario@medstaff.com"},"password":{"type":"string","minLength":8,"example":"senhaSegura123"}}},"LoginResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"token":{"type":"string","description":"Token JWT para autenticação"},"user":{"$ref":"#/components/schemas/User"},"requiresTwoFactor":{"type":"boolean","description":"Indica se é necessário completar 2FA"}}},"RegisterRequest":{"type":"object","required":["email","password","name"],"properties":{"email":{"type":"string","format":"email","example":"novo@medstaff.com"},"password":{"type":"string","minLength":8,"example":"senhaSegura123"},"name":{"type":"string","example":"João Silva"}}},"SecurityMetrics":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"period":{"type":"string","enum":["1h","6h","24h","7d","30d"]},"summary":{"type":"object","properties":{"totalAlerts":{"type":"integer","description":"Total de alertas no período"},"criticalAlerts":{"type":"integer","description":"Alertas críticos no período"},"systemHealth":{"type":"string","enum":["healthy","warning","critical"],"description":"Status geral do sistema"},"lastUpdate":{"type":"string","format":"date-time"}}},"trends":{"type":"object","properties":{"alertsLast1h":{"type":"integer"},"alertsLast6h":{"type":"integer"},"alertsLast24h":{"type":"integer"}}}}},"Alert":{"type":"object","properties":{"id":{"type":"string","description":"ID único do alerta"},"type":{"type":"string","enum":["critical","warning","info"],"description":"Tipo do alerta"},"message":{"type":"string","description":"Mensagem do alerta"},"timestamp":{"type":"string","format":"date-time"},"resolved":{"type":"boolean","description":"Indica se o alerta foi resolvido"},"source":{"type":"string","description":"Origem do alerta"}}},"DashboardStats":{"type":"object","properties":{"totalUsers":{"type":"integer","description":"Total de usuários no sistema"},"totalTasks":{"type":"integer","description":"Total de tarefas"},"totalLeads":{"type":"integer","description":"Total de leads"},"systemHealth":{"type":"string","enum":["healthy","warning","critical"]}}},"TwoFactorStatus":{"type":"object","properties":{"enabled":{"type":"boolean","description":"Indica se o 2FA está habilitado"},"backupCodesCount":{"type":"integer","description":"Número de códigos de backup disponíveis"}}},"Error":{"type":"object","properties":{"error":{"type":"string","description":"Mensagem de erro"},"message":{"type":"string","description":"Detalhes do erro"},"code":{"type":"string","description":"Código do erro"}}},"Success":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","description":"Mensagem de sucesso"},"data":{"type":"object","description":"Dados retornados"}}}},"responses":{"UnauthorizedError":{"description":"Token de acesso inválido ou expirado","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"},"example":{"error":"Token inválido","message":"Token de acesso inválido ou expirado"}}}},"ForbiddenError":{"description":"Acesso negado - permissões insuficientes","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"},"example":{"error":"Acesso negado","message":"Você não tem permissão para acessar este recurso"}}}},"NotFoundError":{"description":"Recurso não encontrado","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"},"example":{"error":"Não encontrado","message":"O recurso solicitado não foi encontrado"}}}},"ValidationError":{"description":"Erro de validação dos dados enviados","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"},"example":{"error":"Dados inválidos","message":"Os dados enviados não passaram na validação"}}}},"RateLimitError":{"description":"Limite de requisições excedido","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"},"example":{"error":"Rate limit excedido","message":"Muitas requisições. Tente novamente em alguns minutos."}}}},"InternalServerError":{"description":"Erro interno do servidor","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"},"example":{"error":"Erro interno do servidor","message":"Ocorreu um erro inesperado no servidor"}}}}}},"tags":[{"name":"Autenticação","description":"Endpoints para autenticação e gerenciamento de usuários"},{"name":"2FA","description":"Endpoints para autenticação de dois fatores"},{"name":"Dashboard","description":"Endpoints para métricas e estatísticas do dashboard"},{"name":"Segurança","description":"Endpoints para monitoramento e alertas de segurança"},{"name":"Alertas","description":"Endpoints para gerenciamento de alertas do sistema"},{"name":"Sistema","description":"Endpoints para monitoramento e saúde do sistema"}],"paths":{"/api/auth/login":{"post":{"summary":"Realizar login no sistema","description":"Autentica um usuário com email e senha, retornando um token JWT","tags":["Autenticação"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}}},"responses":{"200":{"description":"Login realizado com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"400":{"$ref":"#/components/responses/ValidationError"},"401":{"description":"Credenciais inválidas","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"},"example":{"error":"Credenciais inválidas","message":"Email ou senha incorretos"}}}},"429":{"$ref":"#/components/responses/RateLimitError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}},"/api/auth/register":{"post":{"summary":"Registrar novo usuário","description":"Cria uma nova conta de usuário no sistema","tags":["Autenticação"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}}},"responses":{"201":{"description":"Usuário registrado com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"},"example":{"success":true,"message":"Usuário registrado com sucesso","data":{"user":{"id":"123e4567-e89b-12d3-a456-426614174000","email":"novo@medstaff.com","name":"João Silva"}}}}}},"400":{"$ref":"#/components/responses/ValidationError"},"409":{"description":"Email já está em uso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"},"example":{"error":"Email já existe","message":"Este email já está sendo usado por outro usuário"}}}},"429":{"$ref":"#/components/responses/RateLimitError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}},"/api/auth/me":{"get":{"summary":"Obter dados do usuário atual","description":"Retorna os dados do usuário autenticado","tags":["Autenticação"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Dados do usuário obtidos com sucesso","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"user":{"$ref":"#/components/schemas/User"}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"429":{"$ref":"#/components/responses/RateLimitError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}},"/api/auth/logout":{"post":{"summary":"Realizar logout","description":"Invalida o token do usuário e realiza logout","tags":["Autenticação"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Logout realizado com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"},"example":{"success":true,"message":"Logout realizado com sucesso"}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}},"/api/dashboard/quick-stats":{"get":{"summary":"Estatísticas rápidas do dashboard","description":"Retorna estatísticas resumidas do sistema para o dashboard principal","tags":["Dashboard"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Estatísticas obtidas com sucesso","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"$ref":"#/components/schemas/DashboardStats"}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}},"/api/security-dashboard/overview":{"get":{"summary":"Visão geral das métricas de segurança","description":"Retorna uma visão completa das métricas de segurança do sistema (apenas para administradores)","tags":["Segurança"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Métricas de segurança obtidas com sucesso","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"alerts":{"type":"object","properties":{"total":{"type":"integer"},"byType":{"type":"object"},"bySeverity":{"type":"object"},"recent":{"type":"array","items":{"$ref":"#/components/schemas/Alert"}}}},"performance":{"type":"object","properties":{"totalRequests":{"type":"integer"},"averageResponseTime":{"type":"number"},"errorRate":{"type":"number"}}},"timestamp":{"type":"string","format":"date-time"}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}},"/api/security-dashboard/alerts":{"get":{"summary":"Alertas detalhados com filtros e paginação","description":"Retorna lista de alertas de segurança com opções de filtro e paginação","tags":["Segurança"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","minimum":1,"default":1},"description":"Número da página"},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":10},"description":"Número de itens por página"},{"in":"query","name":"severity","schema":{"type":"string","enum":["low","medium","high","critical"]},"description":"Filtrar por severidade"},{"in":"query","name":"type","schema":{"type":"string","enum":["login_attempt","suspicious_activity","system_error","security_breach"]},"description":"Filtrar por tipo de alerta"},{"in":"query","name":"startDate","schema":{"type":"string","format":"date"},"description":"Data inicial para filtro (YYYY-MM-DD)"},{"in":"query","name":"endDate","schema":{"type":"string","format":"date"},"description":"Data final para filtro (YYYY-MM-DD)"}],"responses":{"200":{"description":"Lista de alertas obtida com sucesso","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"alerts":{"type":"array","items":{"$ref":"#/components/schemas/Alert"}},"pagination":{"type":"object","properties":{"page":{"type":"integer"},"limit":{"type":"integer"},"total":{"type":"integer"},"pages":{"type":"integer"}}}}}}}}}},"400":{"$ref":"#/components/responses/ValidationError"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}},"/api/2fa/status":{"get":{"summary":"Verificar status do 2FA","description":"Retorna o status atual da autenticação de dois fatores para o usuário","tags":["Autenticação 2FA"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Status do 2FA obtido com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TwoFactorStatus"}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"429":{"$ref":"#/components/responses/RateLimitError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}},"/api/2fa/generate-secret":{"post":{"summary":"Configurar 2FA","description":"Gera um novo segredo para configuração do 2FA","tags":["Autenticação 2FA"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Segredo 2FA gerado com sucesso","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"secret":{"type":"string","description":"Segredo base32 para configuração no app autenticador"},"qrCode":{"type":"string","description":"URL do QR Code para configuração"}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"429":{"$ref":"#/components/responses/RateLimitError"},"500":{"$ref":"#/components/responses/InternalServerError"}}}}}}